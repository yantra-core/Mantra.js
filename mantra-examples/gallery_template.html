<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Example Gallery</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #000;
    }

    .fixed-controls-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: #f8f9fa;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: #000;
      color: #fff;

    }

    .navigation {
      display: flex;
      justify-content: center;
      flex-grow: 1;
      /* Allows the navigation container to take up all available space */
    }

    .navigation h3,
    .navigation h2 {
      margin: 0;
      padding: 5px 10px;
    }

    .navigation h3 {
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .navigation h3:hover {
      /* better hover color for dark bg*/
      background-color: #333;
      border-radius: 5px;
    }

    .control-buttons-left {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-right: 26px;
      /* Space between playPauseBtn and countdown */
    }


    .control-buttons {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-right: 26px;
      /* Space between playPauseBtn and countdown */
    }

    #countdown {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid #d000ff;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #playPauseBtn {
      padding: 5px 10px;
      cursor: pointer;
      border: none;
      background-color: #d000ff;
      color: white;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    #playPauseBtn:hover {
      background-color: #d000ff;
    }

    iframe {
      width: 100%;
      height: 1200px;
      /* Adjust as needed */
      border: none;
      padding-top: 60px;
      /* Height of the fixed controls container */
    }

    @media (max-width: 768px) {
      .navigation h2 {
        font-size: 16px;
        /* Smaller font size for smaller screens */
      }

      .navigation h3 {
        font-size: 14px;
        /* Smaller font size for smaller screens */
      }
    }
  </style>
</head>

<body>

  <script>
      // listen for messages from the iframe
      window.addEventListener('message', event => {
        // log the data
        console.log(event.data);
        togglePlayPause(true);
        // alert('hide')
      });

  </script>
  <div class="fixed-controls-container">

    <div class="control-buttons-left">
      <select id="exampleDropdown" onchange="loadSelectedExample()">
        <option value="">Select an Example</option>
        <!-- Options will be dynamically populated here -->
      </select>
    </div>


    <div class="navigation">
      <h3 id="prevPreview"></h3>
      <h2 id="exampleTitle"></h2>
      <h3 id="nextPreview"></h3>
    </div>
    <div class="control-buttons">
      <button id="playPauseBtn">Pause</button>
      <div id="countdown">5</div>
    </div>
  </div>
  <iframe id="exampleFrame"></iframe>
  <script>
    // $$$jsCode$$$

    let currentIndex = 0;
    let intervalId;
    let countdownValue = 5; // 5-second countdown
    let isPlaying = true;
    
    function cycleExamples(direction = 'forward') {
        const frame = document.getElementById('exampleFrame');
        const title = document.getElementById('exampleTitle');
        const nextPreview = document.getElementById('nextPreview');
        const prevPreview = document.getElementById('prevPreview');
        const dropdown = document.getElementById('exampleDropdown');
    
        if (direction === 'forward') {
            currentIndex = (currentIndex + 1) % exampleURLs.length;
        } else if (direction === 'backward') {
            currentIndex = (currentIndex - 1 + exampleURLs.length) % exampleURLs.length;
        }
    
        const currentUrl = exampleURLs[currentIndex];
        frame.src = currentUrl;


        // Extract a meaningful part of the URL, for example, the filename without extension
        const urlSegment = currentUrl.split('/').pop().split('.html')[0];
        // TODO: enable push state to example links
        //let pushSegement = currentUrl.replace('.html', '');
        // Update the browser's URL to reflect the current example, using a hash or query parameter
        //window.history.pushState({}, '', pushSegement); // or '?example=' + urlSegment for query parameters
    
        const titleText = currentUrl.split('/').pop().replace('.html', '').replace(/-/g, ' ');
        title.textContent = 'Currently Viewing: ' + titleText;
    
        const nextIndex = (currentIndex + 1) % exampleURLs.length;
        const nextUrl = exampleURLs[nextIndex];
        const nextTitleText = nextUrl.split('/').pop().replace('.html', '').replace(/-/g, ' ');
        nextPreview.textContent = 'Up Next: ' + nextTitleText;
    
        if (currentIndex === 0) {
            prevPreview.style.display = 'none';
        } else {
            prevPreview.style.display = '';
            const prevIndex = (currentIndex - 1 + exampleURLs.length) % exampleURLs.length;
            const prevUrl = exampleURLs[prevIndex];
            const prevTitleText = prevUrl.split('/').pop().replace('.html', '').replace(/-/g, ' ');
            prevPreview.textContent = 'Previously: ' + prevTitleText;
        }
    
        // Update dropdown to show the current example
        dropdown.selectedIndex = currentIndex + 1; // +1 because the first option is "Select an Example"
    
        resetCountdown();
    }
    
    function updateCountdown() {
        const countdown = document.getElementById('countdown');
        countdown.textContent = countdownValue;
        countdownValue--;
    
        if (countdownValue < 0) {
            cycleExamples();
        }
    }
    
    function resetCountdown() {
        countdownValue = 5; // Reset to 5 seconds
        updateCountdown();
    }
    
    function togglePlayPause(forcePause = false) {
        const btn = document.getElementById('playPauseBtn');
        isPlaying = forcePause ? false : !isPlaying;
    
        btn.textContent = isPlaying ? 'Pause' : 'Play';
        if (isPlaying) {
            intervalId = setInterval(updateCountdown, 1000);
        } else {
            clearInterval(intervalId);
        }
    }
    
    document.addEventListener('click', () => {
        togglePlayPause(true); // Pause the timer on any document click
    });
    
    document.getElementById('playPauseBtn').addEventListener('click', (e) => {
        e.stopPropagation(); // Prevent the document click event from firing
        togglePlayPause();
    });
    
    document.getElementById('nextPreview').addEventListener('click', (e) => {
        e.stopPropagation();
        cycleExamples('forward');
    });
    
    document.getElementById('prevPreview').addEventListener('click', (e) => {
        e.stopPropagation();
        cycleExamples('backward');
    });
    
    function populateDropdown() {
        const dropdown = document.getElementById('exampleDropdown');
        exampleURLs.forEach((url, index) => {
            const option = document.createElement('option');
            const title = url.split('/').pop().replace('.html', '').replace(/-/g, ' ');
            option.text = title;
            option.value = index;
            dropdown.appendChild(option);
        });
    }
    
    function loadSelectedExample() {
        const dropdown = document.getElementById('exampleDropdown');
        const selectedValue = dropdown.value;
    
        if (selectedValue) {
            currentIndex = parseInt(selectedValue, 10);
            togglePlayPause(true); // Force pause when selecting from dropdown
            cycleExamples();
        }
    }
    
    document.getElementById('exampleDropdown').addEventListener('change', loadSelectedExample);
    
    function startGallery() {
        populateDropdown();
        intervalId = setInterval(updateCountdown, 1000);
        cycleExamples();
    }
    
    startGallery();
    

  </script>
</body>

</html>