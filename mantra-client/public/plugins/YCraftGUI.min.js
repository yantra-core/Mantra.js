(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.PLUGINS || (g.PLUGINS = {})).YCraftGUI = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var gui={elementList:["gui-container","gui-content","gui-header","gui-header-title","traffic-light","close","minimize","maximize","resizeHandle","gui-window-footer"],window:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Window",n=arguments.length>2?arguments[2]:void 0,i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],this);void 0===n&&(n=function(){console.log("WARNING: No close function provided for window with id: "+e+", defaulting to remove()"),document.getElementById(e).remove()});var o="gui-container",l="gui-content",a="gui-header";is_touch_enabled();var s=document.createElement("div");s.id=e,s.className=o;var c=document.createElement("div");c.className=l;var d=document.createElement("div");d.className=a;var u=document.createElement("div");u.className="traffic-light-container";var r=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div");r.className="traffic-light close",m.className="traffic-light minimize",f.className="traffic-light maximize",m.onclick=function(){return n()},r.onclick=function(){return n()},f.onclick=function(){i.maxWindow(s)},u.appendChild(r),u.appendChild(m),u.appendChild(f),d.appendChild(u);var p=document.createElement("h3");p.textContent=t,p.ondblclick=function(){i.maxWindow(s)},d.appendChild(p),s.appendChild(d),s.appendChild(c);var v=document.createElement("div");return v.className="resizeHandle",s.appendChild(v),document.body.appendChild(s),this.initializeDrag(d,s),this.initializeResize(v,s),s.addEventListener("click",function(){gui.bringToFront(s)}),s},maxWindow:function(e){"100vw"===e.style.width?(e.style.width="50%",e.style.height="50%",void 0!==e.lastTop?(e.style.top=e.lastTop,e.style.left=e.lastLeft):(e.style.top="20%",e.style.left="20%")):(e.lastTop=e.style.top,e.lastLeft=e.style.left,e.style.width="100vw",e.style.height="90%",e.style.top="50px",e.style.left="0px")},initializeResize:function(e,t){var n=this;e.addEventListener("mousedown",function(e){e.preventDefault(),gui.bringToFront(t),window.addEventListener("mousemove",i),window.addEventListener("mouseup",o)});var i=function(e){n.container.style.width=e.clientX-n.container.offsetLeft+"px",n.container.style.height=e.clientY-n.container.offsetTop+"px"},o=function(){window.removeEventListener("mousemove",i)}},initializeDrag:function(e,t){var n=0,i=0,o=0,l=0;function a(t){(t=t||window.event).preventDefault(),n=o-t.clientX,i=l-t.clientY,o=t.clientX,l=t.clientY,e.parentElement.style.top=e.parentElement.offsetTop-i+"px",e.parentElement.style.left=e.parentElement.offsetLeft-n+"px"}function s(){document.onmouseup=null,document.onmousemove=null}e.onmousedown=function(e){(e=e||window.event).preventDefault(),gui.bringToFront(t),o=e.clientX,l=e.clientY,document.onmouseup=s,document.onmousemove=a}},bringToFront:function(e){document.querySelectorAll(".gui-container").forEach(function(e){e.style.zIndex="1000"}),e.style.zIndex="1010"},init:function(e){"undefined"!=typeof document?(document.addEventListener("click",function(t){var n=t.target.closest(".gui-container");e&&e.systems&&e.systems["entity-input"]&&e.systems.keyboard&&(n?(e.systems["entity-input"].disableInputs(),e.systems.keyboard.unbindAllEvents()):(e.systems["entity-input"].setInputsActive(),e.systems.keyboard.bindInputControls()))}),document.addEventListener("keydown",function(e){if("Escape"===e.key){var t=document.querySelectorAll(".gui-container"),n=t[t.length-1];n&&n.remove()}})):console.log("gui-plugin: document not found, skipping initialization")}},_default=exports.default=gui;function is_touch_enabled(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}

},{}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _gui=_interopRequireDefault(require("../gui-editor/gui.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(_getRequireWildcardCache=function(t){return t?n:e})(t)}function _interopRequireWildcard(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=_typeof(t)&&"function"!=typeof t)return{default:t};var n=_getRequireWildcardCache(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var i=o?Object.getOwnPropertyDescriptor(t,a):null;i&&(i.get||i.set)?Object.defineProperty(r,a,i):r[a]=t[a]}return r.default=t,n&&n.set(t,r),r}function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new I(r||[]);return o(i,"_invoke",{value:j(t,n,c)}),i}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function w(){}var _={};s(_,i,function(){return this});var b=Object.getPrototypeOf,x=b&&b(b(R([])));x&&x!==n&&r.call(x,i)&&(_=x);var E=w.prototype=m.prototype=Object.create(_);function C(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function k(t,e){function n(o,a,i,c){var u=p(t[o],t,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==_typeof(l)&&r.call(l,"__await")?e.resolve(l.__await).then(function(t){n("next",t,i,c)},function(t){n("throw",t,i,c)}):e.resolve(l).then(function(t){s.value=t,i(s)},function(t){return n("throw",t,i,c)})}c(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function o(){return new e(function(e,o){n(t,r,e,o)})}return a=a?a.then(o,o):o()}})}function j(e,n,r){var o=f;return function(a,i){if(o===d)throw new Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var u=L(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var s=p(e,n,r);if("normal"===s.type){if(o=r.done?y:h,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=y,r.method="throw",r.arg=s.arg)}}}function L(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=p(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(_typeof(e)+" is not iterable")}return g.prototype=w,o(E,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=s(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},C(k.prototype),s(k.prototype,c,function(){return this}),e.AsyncIterator=k,e.async=function(t,n,r,o,a){void 0===a&&(a=Promise);var i=new k(l(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},C(E),s(E,u,"Generator"),s(E,i,function(){return this}),s(E,"toString",function(){return"[object Generator]"}),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function asyncGeneratorStep(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){asyncGeneratorStep(a,r,o,i,c,"next",t)}function c(t){asyncGeneratorStep(a,r,o,i,c,"throw",t)}i(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var YCraftGUI=function(){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classCallCheck(this,t),this.id=t.id,this.logContainer=null,this.logTextArea=null,this.pingTestComplete=!1,this.etherspaceHost="https://etherspace.ayyo.gg/api/v1",this.etherspaceEndpoint=this.etherspaceHost+""}return _createClass(t,[{key:"init",value:function(t){this.game=t,this.game.systemsManager.addSystem(this.id,this);this.createContraptionViewer()}},{key:"createContraptionViewer",value:function(){this.game;var t=document.getElementById("contraptionsView");t&&(t.display="block"),this.container=document.createElement("div"),this.container.id="contraptionsView",this.container=document.createElement("div"),this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.alignItems="center",this.container.style.height="100%";document.getElementById("contraption-select")}},{key:"updateSelectDropdown",value:function(t){var e=document.getElementById("contraption-select");if(e)e.value=t;else{var n=document.createElement("select");n.id="contraption-select";var r=document.createElement("option");r.value=t,r.textContent=t,n.appendChild(r),n.value=t}}},{key:"getContraption",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r,o,a,i,c,u,s,l,p;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,r=this.game,o=document.getElementById("contraption-name-display"),t.next=5,fetch("".concat(this.etherspaceEndpoint,"/contraption/").concat(e));case 5:return a=t.sent,t.next=8,a.json();case 8:if(i=t.sent,o&&(o.textContent=i?i.name:"Could not find: "+e),(c=document.getElementById("display-contraption"))&&(c.style.display="block"),u=document.getElementById("contraption-code")){for(s=i.code,l=s.split("\n");""===l[0];)l.shift();s=l.join("\n"),u.value=s}(p=document.getElementById("contraption-name"))&&(p.value=i.name),this.updateSelectDropdown(i.name),r.systems.ycraft&&r.systems.ycraft.clearAllParts(),!0,setTimeout(function(){n.runContraptionModule(i.code)},200);case 20:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"setContraption",value:function(t,e){this.contraption=t,this.createContraptionViewer(t)}},{key:"renderDropdown",value:function(t){var e=this,n=(document.getElementById("contraption-interface"),document.createElement("select"));n.id="contraption-select";var r=document.createElement("label");r.setAttribute("for","contraption-select"),r.textContent="Contraption: ",t.forEach(function(t){var e=document.createElement("option");e.value=t.name,e.textContent=t.name,n.appendChild(e)});var o=document.getElementById("display-contraption");o&&o.appendChild(n),n.addEventListener("change",function(t){var n=t.target.value;console.log("User selected contraption name: ".concat(n)),e.getContraption(n)})}},{key:"createDisplay",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,this.game,n=document.getElementById("save-contraption-form"),document.getElementById("contraption-name-display"),n&&n.addEventListener("submit",function(t){t.preventDefault();var e=document.getElementById("contraption-name").value;saveContraption(e)}),"Marak",t.next=8,e.fetchContraptionsForUser("Marak");case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"saveContraption",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r,o,a,i;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=document.getElementById("contraption-code").value,r={name:e,code:n||""},t.prev=2,t.next=5,fetch("".concat(this.etherspaceEndpoint,"/api/v1/contraption/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 5:return o=t.sent,t.next=8,o.json();case 8:a=t.sent,o.ok?contraptionNameDisplay.textContent="Saved: ".concat(a.name):contraptionNameDisplay.textContent="Error saving contraption: ".concat(a.message),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),contraptionNameDisplay.textContent="Network error: ".concat(t.t0.message);case 15:(i=document.getElementById("display-contraption"))&&(i.style.display="block");case 17:case"end":return t.stop()}},t,this,[[2,12]])}));return function(e){return t.apply(this,arguments)}}()},{key:"fetchContraptionsForUser",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(this.etherspaceEndpoint,"/contraptions/").concat(e));case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,this.renderDropdown(r),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("Error fetching contraptions:",t.t0);case 13:case"end":return t.stop()}},t,this,[[0,10]])}));return function(e){return t.apply(this,arguments)}}()},{key:"runContraptionModule",value:function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r,o,a,i,c;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.game,t.prev=1,console.log("About to run code",e),r=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(r),t.next=7,function(t){return new Promise(function(e){return e("".concat(t))}).then(function(t){return _interopRequireWildcard(require(t))})}(o);case 7:a=t.sent,i=a.default(),c=a.default.name,window[c]=i,window[c]&&n.systems.ycraft.setContraption(window[c]),i.start,URL.revokeObjectURL(o),console.log("Contraption loaded and executed"),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),console.error("Error running contraption:",t.t0);case 20:case"end":return t.stop()}},t,this,[[1,17]])}));return function(e){return t.apply(this,arguments)}}()},{key:"adjustTextareaHeight",value:function(t){t.style.height="auto",t.style.height=t.scrollHeight+"px"}},{key:"unload",value:function(){var t=document.getElementById("contraption-interface");t&&t.remove(),this.logContainer&&this.logContainer.parentNode&&this.logContainer.parentNode.removeChild(this.logContainer);var e=document.getElementById("contraptionsView");e&&(e.display="hidden"),this.logContainer=null,this.logTextArea=null}}]),t}();_defineProperty(YCraftGUI,"id","gui-ycraft");var _default=exports.default=YCraftGUI;

},{"../gui-editor/gui.js":1}]},{},[2])(2)
});
