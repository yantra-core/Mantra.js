(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.PLUGINS || (g.PLUGINS = {})).Gamepad = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _BitdoNES30Pro=_interopRequireDefault(require("./gamepads/8BitdoNES30Pro.js")),_Playstation=_interopRequireDefault(require("./gamepads/Playstation3.js")),_LogitechDualAction=_interopRequireDefault(require("./gamepads/LogitechDualAction.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var axesAssociation={DPAD_HORIZONTAL:["DPAD_LEFT","DPAD_RIGHT"],DPAD_VERTICAL:["DPAD_UP","DPAD_DOWN"],LEFT_STICK_HORIZONTAL:["LEFT_STICK_LEFT","LEFT_STICK_RIGHT"],LEFT_STICK_VERTICAL:["LEFT_STICK_UP","LEFT_STICK_DOWN"],RIGHT_STICK_HORIZONTAL:["RIGHT_STICK_LEFT","RIGHT_STICK_RIGHT"],RIGHT_STICK_VERTICAL:["RIGHT_STICK_UP","RIGHT_STICK_DOWN"]},Gamepad=exports.default=function(){function e(){_classCallCheck(this,e),this.id=e.id,this.gamepads={},this.configs={"8Bitdo NES30 Pro (Vendor: 2dc8 Product: 3820)":_BitdoNES30Pro.default,"Logitech Logitech Dual Action":_LogitechDualAction.default,"Sony PLAYSTATION(R)3 Controller":_Playstation.default},this.hashes={},this.controls={DPAD_UP:!1,DPAD_DOWN:!1,DPAD_LEFT:!1,DPAD_RIGHT:!1,LEFT_STICK_UP:!1,LEFT_STICK_DOWN:!1,LEFT_STICK_LEFT:!1,LEFT_STICK_RIGHT:!1,RIGHT_STICK_UP:!1,RIGHT_STICK_DOWN:!1,RIGHT_STICK_LEFT:!1,RIGHT_STICK_RIGHT:!1,BUTTON_Y:!1,BUTTON_X:!1,BUTTON_B:!1,BUTTON_A:!1,BUTTON_START:!1,BUTTON_SELECT:!1,BUTTON_L1:!1,BUTTON_R1:!1,BUTTON_L2:!1,BUTTON_R2:!1,BUTTON_L3:!1,BUTTON_R3:!1,BUTTON_STICK_L:!1,BUTTON_STICK_R:!1},this.lastControlsAllFalse=!0}return _createClass(e,[{key:"init",value:function(t){var n=this;this.game=t,this.id=e.id,t.systemsManager.addSystem("gamepad",this),this.game.isServer||(window.addEventListener("gamepadconnected",function(e){return n.connectHandler(e)}),window.addEventListener("gamepaddisconnected",function(e){return n.disconnectHandler(e)}))}},{key:"connectHandler",value:function(e){console.log("Gamepad connected at index ".concat(e.gamepad.index,": ").concat(e.gamepad.id,". ").concat(e.gamepad.buttons.length," buttons, ").concat(e.gamepad.axes.length," axes.")),this.gamepads[e.gamepad.index]=e.gamepad}},{key:"disconnectHandler",value:function(e){console.log("Gamepad disconnected from index ".concat(e.gamepad.index,": ").concat(e.gamepad.id)),delete this.gamepads[e.gamepad.index]}},{key:"update",value:function(){this.game.isServer||(this.pollGamepads(),this.sendInputs())}},{key:"pollGamepads",value:function(){for(var e=navigator.getGamepads?navigator.getGamepads():[],t=0;t<e.length;t++)e[t]&&(this.gamepads[t]=e[t])}},{key:"controllerConfig",value:function(t){return"object"===_typeof(this.configs[t])?this.configs[t]:e.defaultControllerConfig}},{key:"sendInputs",value:function(){var e=this,t=function(){if(-1!==e.gamepads[n].id.indexOf("Virtual"))return 1;var t=e.controllerConfig(e.gamepads[n].id),o=e.gamepads[n];Object.keys(t.buttons).forEach(function(n){e.controls[n]=o.buttons[t.buttons[n]].pressed}),Object.keys(t.axes).forEach(function(n){var a=axesAssociation[n],i=o.axes[t.axes[n]];e.controls[a[0]]=i<-.1,e.controls[a[1]]=i>.1});var a=e.controls;e.game.communicationClient&&e.game.communicationClient.sendMessage("player_input",{controls:a})};for(var n in this.gamepads)t()}}]),e}();_defineProperty(Gamepad,"id","gamepad"),_defineProperty(Gamepad,"defaultControllerConfig",{buttons:{BUTTON_A:0,BUTTON_B:2,BUTTON_X:3,BUTTON_Y:1,BUTTON_L1:4,BUTTON_R1:5,BUTTON_L2:6,BUTTON_R2:7,BUTTON_SELECT:8,BUTTON_START:9,BUTTON_STICK_L:10,BUTTON_STICK_R:11},axes:{DPAD_HORIZONTAL:0,DPAD_VERTICAL:1,LEFT_STICK_HORIZONTAL:2,LEFT_STICK_VERTICAL:3,RIGHT_STICK_HORIZONTAL:4,RIGHT_STICK_VERTICAL:5}});

},{"./gamepads/8BitdoNES30Pro.js":2,"./gamepads/LogitechDualAction.js":3,"./gamepads/Playstation3.js":4}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.controllerConfig=void 0;var controllerConfig=exports.controllerConfig={buttons:{BUTTON_A:0,BUTTON_B:1,BUTTON_X:3,BUTTON_Y:4,BUTTON_L1:6,BUTTON_R1:7,BUTTON_L2:8,BUTTON_R2:9,BUTTON_SELECT:10,BUTTON_START:11,BUTTON_STICK_L:13,BUTTON_STICK_R:14},axes:{LEFT_STICK_HORIZONTAL:0,LEFT_STICK_VERTICAL:1,RIGHT_STICK_HORIZONTAL:2,RIGHT_STICK_VERTICAL:5,DPAD_HORIZONTAL:0,DPAD_VERTICAL:1}},_default=exports.default=controllerConfig;

},{}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.controllerConfig=void 0;var controllerConfig=exports.controllerConfig={buttons:{BUTTON_A:1,BUTTON_B:0,BUTTON_X:3,BUTTON_Y:2,BUTTON_L1:4,BUTTON_R1:5,BUTTON_L2:6,BUTTON_R2:7,BUTTON_SELECT:8,BUTTON_START:9,BUTTON_STICK_L:10,BUTTON_STICK_R:11,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15},axes:{LEFT_STICK_HORIZONTAL:0,LEFT_STICK_VERTICAL:1,RIGHT_STICK_HORIZONTAL:2,RIGHT_STICK_VERTICAL:3}},_default=exports.default=controllerConfig;

},{}],4:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.controllerConfig=void 0;var controllerConfig=exports.controllerConfig={buttons:{BUTTON_A:1,BUTTON_B:0,BUTTON_X:3,BUTTON_Y:2,BUTTON_L1:4,BUTTON_R1:5,BUTTON_L2:6,BUTTON_R2:7,BUTTON_SELECT:8,BUTTON_START:9,BUTTON_STICK_L:10,BUTTON_STICK_R:11,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,HOME:16},axes:{LEFT_STICK_HORIZONTAL:0,LEFT_STICK_VERTICAL:1,RIGHT_STICK_HORIZONTAL:2,RIGHT_STICK_VERTICAL:3}},_default=exports.default=controllerConfig;

},{}]},{},[1])(1)
});
