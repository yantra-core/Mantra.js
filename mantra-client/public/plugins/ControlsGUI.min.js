(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.PLUGINS || (g.PLUGINS = {})).ControlsGUI = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _gui=_interopRequireDefault(require("../gui-editor/gui.js"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _defineProperty(t,e,i){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ControlsGUI=function(){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classCallCheck(this,t),this.id=t.id,this.highlightedKeys={}}return _createClass(t,[{key:"init",value:function(t){this.game=t,this.listenForEntityInput(),this.game.systemsManager.addSystem(this.id,this),this.drawTable()}},{key:"drawTable",value:function(){var e=this.game;if(e.systems["entity-input"]){this.controlsView&&this.controlsView.remove();var i=e.systemsManager.getSystem("entity-input").controlMappings,r=document.createElement("table");r.id="controlsTable";for(var n in r.innerHTML="<tr><th>Key</th><th>Action</th></tr>",i){var o=r.insertRow();o.id="row-".concat(n);var l=o.insertCell(),s=o.insertCell();l.textContent=n,s.textContent=i[n]}this.controlsView=_gui.default.window("controlsView","Input Controls",function(){e.systemsManager.removeSystem(t.id)}),this.controlsView.querySelector(".gui-content").appendChild(r)}}},{key:"listenForEntityInput",value:function(t){var e=this,i=this.game,r=this;i.on("entityInput::handleInputs",function(t,i,r){if(i){var n=i.controls;for(var o in e.highlightedKeys)document.getElementById("row-".concat(o)).style.backgroundColor="";for(var l in e.highlightedKeys={},n){var s=document.getElementById("row-".concat(l));s&&n[l]&&(s.style.backgroundColor="#00ff00",e.highlightedKeys[l]=!0)}}}),i.on("inputStrategyRegistered",function(t){t.forEach(function(t){r.drawTable()})}),this.clearHighlightsInterval=setInterval(this.clearHighlights.bind(this),500)}},{key:"clearHighlights",value:function(){for(var t in this.highlightedKeys)document.getElementById("row-".concat(t)).style.backgroundColor="";this.highlightedKeys={}}},{key:"unload",value:function(){this.listener&&(this.game.offAny(this.listener),this.listener=null),this.controlsView&&this.controlsView.remove(),clearInterval(this.clearHighlightsInterval)}}]),t}();_defineProperty(ControlsGUI,"id","gui-controls");var _default=exports.default=ControlsGUI;

},{"../gui-editor/gui.js":2}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var gui={elementList:["gui-container","gui-content","gui-header","gui-header-title","traffic-light","close","minimize","maximize","resizeHandle","gui-window-footer"],window:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Window",n=arguments.length>2?arguments[2]:void 0,i=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],this);void 0===n&&(n=function(){console.log("WARNING: No close function provided for window with id: "+e+", defaulting to remove()"),document.getElementById(e).remove()});var o="gui-container",l="gui-content",a="gui-header";is_touch_enabled();var s=document.createElement("div");s.id=e,s.className=o;var c=document.createElement("div");c.className=l;var d=document.createElement("div");d.className=a;var u=document.createElement("div");u.className="traffic-light-container";var r=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div");r.className="traffic-light close",m.className="traffic-light minimize",f.className="traffic-light maximize",m.onclick=function(){return n()},r.onclick=function(){return n()},f.onclick=function(){i.maxWindow(s)},u.appendChild(r),u.appendChild(m),u.appendChild(f),d.appendChild(u);var p=document.createElement("h3");p.textContent=t,p.ondblclick=function(){i.maxWindow(s)},d.appendChild(p),s.appendChild(d),s.appendChild(c);var v=document.createElement("div");return v.className="resizeHandle",s.appendChild(v),document.body.appendChild(s),this.initializeDrag(d,s),this.initializeResize(v,s),s.addEventListener("click",function(){gui.bringToFront(s)}),s},maxWindow:function(e){"100vw"===e.style.width?(e.style.width="50%",e.style.height="50%",void 0!==e.lastTop?(e.style.top=e.lastTop,e.style.left=e.lastLeft):(e.style.top="20%",e.style.left="20%")):(e.lastTop=e.style.top,e.lastLeft=e.style.left,e.style.width="100vw",e.style.height="90%",e.style.top="50px",e.style.left="0px")},initializeResize:function(e,t){var n=this;e.addEventListener("mousedown",function(e){e.preventDefault(),gui.bringToFront(t),window.addEventListener("mousemove",i),window.addEventListener("mouseup",o)});var i=function(e){n.container.style.width=e.clientX-n.container.offsetLeft+"px",n.container.style.height=e.clientY-n.container.offsetTop+"px"},o=function(){window.removeEventListener("mousemove",i)}},initializeDrag:function(e,t){var n=0,i=0,o=0,l=0;function a(t){(t=t||window.event).preventDefault(),n=o-t.clientX,i=l-t.clientY,o=t.clientX,l=t.clientY,e.parentElement.style.top=e.parentElement.offsetTop-i+"px",e.parentElement.style.left=e.parentElement.offsetLeft-n+"px"}function s(){document.onmouseup=null,document.onmousemove=null}e.onmousedown=function(e){(e=e||window.event).preventDefault(),gui.bringToFront(t),o=e.clientX,l=e.clientY,document.onmouseup=s,document.onmousemove=a}},bringToFront:function(e){document.querySelectorAll(".gui-container").forEach(function(e){e.style.zIndex="1000"}),e.style.zIndex="1010"},init:function(e){"undefined"!=typeof document?(document.addEventListener("click",function(t){var n=t.target.closest(".gui-container");e&&e.systems&&e.systems["entity-input"]&&e.systems.keyboard&&(n?(e.systems["entity-input"].disableInputs(),e.systems.keyboard.unbindAllEvents()):(e.systems["entity-input"].setInputsActive(),e.systems.keyboard.bindInputControls()))}),document.addEventListener("keydown",function(e){if("Escape"===e.key){var t=document.querySelectorAll(".gui-container"),n=t[t.length-1];n&&n.remove()}})):console.log("gui-plugin: document not found, skipping initialization")}},_default=exports.default=gui;function is_touch_enabled(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}

},{}]},{},[1])(1)
});
